<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/org/iesch/a03_menu_principal/settings/SettingsActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/org/iesch/a03_menu_principal/settings/SettingsActivity.kt" />
              <option name="originalContent" value="package org.iesch.a03_menu_principal.settings&#10;&#10;import android.content.Context&#10;import android.os.Bundle&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.appcompat.app.AppCompatActivity&#10;import androidx.appcompat.app.AppCompatDelegate&#10;import androidx.core.view.ViewCompat&#10;import androidx.core.view.WindowInsetsCompat&#10;import androidx.datastore.core.DataStore&#10;import androidx.datastore.preferences.core.Preferences&#10;import androidx.datastore.preferences.core.booleanPreferencesKey&#10;import androidx.datastore.preferences.core.edit&#10;import androidx.datastore.preferences.preferencesDataStore&#10;import androidx.lifecycle.lifecycleScope&#10;import kotlinx.coroutines.flow.first&#10;import kotlinx.coroutines.launch&#10;import org.iesch.a03_menu_principal.R&#10;import org.iesch.a03_menu_principal.databinding.ActivitySettingsBinding&#10;&#10;private val Context.settingsDataStore: DataStore&lt;Preferences&gt; by preferencesDataStore(name = &quot;settings&quot;)&#10;&#10;class SettingsActivity : AppCompatActivity() {&#10;&#10;    companion object {&#10;        private val KEY_DARKMODE = booleanPreferencesKey(&quot;darkmode_enabled&quot;)&#10;        private val KEY_BLUETOOTH = booleanPreferencesKey(&quot;bluetooth_enabled&quot;)&#10;        private val KEY_VIBRATION = booleanPreferencesKey(&quot;vibration_enabled&quot;)&#10;&#10;        // Método estático para aplicar el tema desde cualquier actividad&#10;        suspend fun applyTheme(context: Context) {&#10;            val preferences = context.settingsDataStore.data.first()&#10;            val isDarkMode = preferences[KEY_DARKMODE] ?: false&#10;            val mode = if (isDarkMode) AppCompatDelegate.MODE_NIGHT_YES else AppCompatDelegate.MODE_NIGHT_NO&#10;            AppCompatDelegate.setDefaultNightMode(mode)&#10;        }&#10;&#10;        // Función para limpiar todas las configuraciones&#10;        suspend fun clearSettings(context: Context) {&#10;            context.settingsDataStore.edit { preferences -&gt;&#10;                preferences.clear()&#10;            }&#10;            // Restaurar modo claro por defecto&#10;            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)&#10;        }&#10;    }&#10;&#10;    private lateinit var binding: ActivitySettingsBinding&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        // Aplicar tema antes de crear la vista&#10;        lifecycleScope.launch {&#10;            applyTheme(this@SettingsActivity)&#10;        }&#10;&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        binding = ActivitySettingsBinding.inflate(layoutInflater)&#10;        setContentView(binding.root)&#10;        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main)) { v, insets -&gt;&#10;            val systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars())&#10;            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom)&#10;            insets&#10;        }&#10;&#10;        // Cargar preferencias guardadas&#10;        lifecycleScope.launch {&#10;            val preferences = settingsDataStore.data.first()&#10;            binding.swDarkmode.isChecked = preferences[KEY_DARKMODE] ?: false&#10;            binding.swBluetooth.isChecked = preferences[KEY_BLUETOOTH] ?: false&#10;            binding.swVibracion.isChecked = preferences[KEY_VIBRATION] ?: true&#10;        }&#10;&#10;        initUI()&#10;    }&#10;&#10;    private fun initUI() {&#10;        binding.rsVolumen.addOnChangeListener { _, value, _ -&gt;&#10;            // Manejo del volumen...&#10;        }&#10;&#10;        binding.swDarkmode.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_DARKMODE] = isChecked&#10;                }&#10;                applyTheme(this@SettingsActivity)&#10;                recreate()&#10;            }&#10;        }&#10;&#10;        binding.swBluetooth.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_BLUETOOTH] = isChecked&#10;                }&#10;            }&#10;        }&#10;&#10;        binding.swVibracion.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_VIBRATION] = isChecked&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package org.iesch.a03_menu_principal.settings&#10;&#10;import android.content.Context&#10;import android.os.Bundle&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.appcompat.app.AppCompatActivity&#10;import androidx.appcompat.app.AppCompatDelegate&#10;import androidx.core.view.ViewCompat&#10;import androidx.core.view.WindowInsetsCompat&#10;import androidx.datastore.core.DataStore&#10;import androidx.datastore.preferences.core.Preferences&#10;import androidx.datastore.preferences.core.booleanPreferencesKey&#10;import androidx.datastore.preferences.core.edit&#10;import androidx.datastore.preferences.preferencesDataStore&#10;import androidx.lifecycle.lifecycleScope&#10;import kotlinx.coroutines.flow.first&#10;import kotlinx.coroutines.launch&#10;import org.iesch.a03_menu_principal.R&#10;import org.iesch.a03_menu_principal.databinding.ActivitySettingsBinding&#10;&#10;private val Context.settingsDataStore: DataStore&lt;Preferences&gt; by preferencesDataStore(name = &quot;settings&quot;)&#10;&#10;class SettingsActivity : AppCompatActivity() {&#10;&#10;    companion object {&#10;        private val KEY_DARKMODE = booleanPreferencesKey(&quot;darkmode_enabled&quot;)&#10;        private val KEY_BLUETOOTH = booleanPreferencesKey(&quot;bluetooth_enabled&quot;)&#10;        private val KEY_VIBRATION = booleanPreferencesKey(&quot;vibration_enabled&quot;)&#10;&#10;        // Método estático para aplicar el tema desde cualquier actividad&#10;        suspend fun applyTheme(context: Context) {&#10;            val preferences = context.settingsDataStore.data.first()&#10;            val isDarkMode = preferences[KEY_DARKMODE] ?: false&#10;            val mode = if (isDarkMode) AppCompatDelegate.MODE_NIGHT_YES else AppCompatDelegate.MODE_NIGHT_NO&#10;            AppCompatDelegate.setDefaultNightMode(mode)&#10;        }&#10;&#10;        // Función para limpiar todas las configuraciones&#10;        suspend fun clearSettings(context: Context) {&#10;            context.settingsDataStore.edit { preferences -&gt;&#10;                preferences.clear()&#10;            }&#10;            // Restaurar modo claro por defecto&#10;            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)&#10;        }&#10;    }&#10;&#10;    private lateinit var binding: ActivitySettingsBinding&#10;&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        // Aplicar tema antes de crear la vista&#10;        lifecycleScope.launch {&#10;            applyTheme(this@SettingsActivity)&#10;        }&#10;&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        binding = ActivitySettingsBinding.inflate(layoutInflater)&#10;        setContentView(binding.root)&#10;        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main)) { v, insets -&gt;&#10;            val systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars())&#10;            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom)&#10;            insets&#10;        }&#10;&#10;        // Cargar preferencias guardadas&#10;        lifecycleScope.launch {&#10;            val preferences = settingsDataStore.data.first()&#10;            binding.swDarkmode.isChecked = preferences[KEY_DARKMODE] ?: false&#10;            binding.swBluetooth.isChecked = preferences[KEY_BLUETOOTH] ?: false&#10;            binding.swVibracion.isChecked = preferences[KEY_VIBRATION] ?: true&#10;        }&#10;&#10;        initUI()&#10;    }&#10;&#10;    private fun initUI() {&#10;        binding.rsVolumen.addOnChangeListener { _, value, _ -&gt;&#10;            // Manejo del volumen...&#10;        }&#10;&#10;        binding.swDarkmode.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_DARKMODE] = isChecked&#10;                }&#10;                applyTheme(this@SettingsActivity)&#10;                recreate()&#10;            }&#10;        }&#10;&#10;        binding.swBluetooth.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_BLUETOOTH] = isChecked&#10;                }&#10;            }&#10;        }&#10;&#10;        binding.swVibracion.setOnCheckedChangeListener { _, isChecked -&gt;&#10;            lifecycleScope.launch {&#10;                settingsDataStore.edit { preferences -&gt;&#10;                    preferences[KEY_VIBRATION] = isChecked&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>